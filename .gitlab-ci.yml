include:
  - project: 'aicactus/common/ci'
    file: '/gitlab-ci/workflow.yaml'
  - project: 'aicactus/common/ci'
    file: '/gitlab-ci/label.yaml'
  - project: 'aicactus/common/ci'
    file: '/gitlab-ci/build.yaml'
  - project: 'aicactus/common/ci'
    file: '/gitlab-ci/deploy.yaml'

# variables:
#   DOCKER_HOST: tcp://gitlab-ci-dind.gitlab-ci.svc.cluster.local:2375

stages:
  - label
  - build
  - push-image
  - deploy

Build:
  extends: .build
  script:
    - make build-ci

Push images to registry:
  extends: .push

Deploy to staging:
  extends: .deploy-staging
